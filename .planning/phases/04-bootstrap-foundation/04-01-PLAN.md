---
phase: 04-bootstrap-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ___/templates/base.html
  - ___/templates/home.html
  - ___/templates/registration/login.html
  - ___/templates/registration/register.html
autonomous: true

must_haves:
  truths:
    - "Opening any page loads Bootstrap CSS without console errors"
    - "All existing pages extend base.html and render correctly"
    - "Pages display appropriately on mobile viewport (375px width)"
  artifacts:
    - path: "___/templates/base.html"
      provides: "Base template with Bootstrap 5.3.8 CDN includes"
      min_lines: 25
      contains: "bootstrap@5.3.8"
    - path: "___/templates/home.html"
      provides: "Home page extending base template"
      contains: "{% extends 'base.html' %}"
    - path: "___/templates/registration/login.html"
      provides: "Login page extending base template"
      contains: "{% extends 'base.html' %}"
    - path: "___/templates/registration/register.html"
      provides: "Registration page extending base template"
      contains: "{% extends 'base.html' %}"
  key_links:
    - from: "___/templates/base.html"
      to: "jsDelivr CDN"
      via: "Bootstrap CSS and JS link tags"
      pattern: "cdn\\.jsdelivr\\.net/npm/bootstrap@5\\.3\\.8"
    - from: "___/templates/home.html"
      to: "___/templates/base.html"
      via: "extends statement"
      pattern: "\\{%\\s*extends\\s+'base\\.html'\\s*%\\}"
    - from: "___/templates/registration/login.html"
      to: "___/templates/base.html"
      via: "extends statement"
      pattern: "\\{%\\s*extends\\s+'base\\.html'\\s*%\\}"
    - from: "___/templates/registration/register.html"
      to: "___/templates/base.html"
      via: "extends statement"
      pattern: "\\{%\\s*extends\\s+'base\\.html'\\s*%\\}"
---

<objective>
Create Bootstrap 5.3.8 foundation via CDN integration and migrate existing templates to inheritance pattern.

Purpose: Establish responsive styling infrastructure for all pages without package dependencies, enabling subsequent UI polish phases.

Output: Base template with Bootstrap CDN includes and all existing templates refactored to extend base.html.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/research/SUMMARY.md
@.planning/research/STACK.md
@.planning/codebase/ARCHITECTURE.md

Existing templates to migrate:
@___/templates/home.html
@___/templates/registration/login.html
@___/templates/registration/register.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create base.html with Bootstrap 5.3.8 CDN includes</name>
  <files>___/templates/base.html</files>
  <action>
Create base template at `___/templates/base.html` with:

1. HTML5 doctype and Spanish language attribute (`lang="es"`)
2. Meta tags in `<head>`:
   - charset UTF-8
   - viewport for mobile responsiveness: `<meta name="viewport" content="width=device-width, initial-scale=1">`
3. Bootstrap 5.3.8 CSS from jsDelivr CDN with SRI integrity hash:
   ```html
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
         rel="stylesheet"
         integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
         crossorigin="anonymous">
   ```
4. Template blocks:
   - `{% block title %}Pagina Madre{% endblock %}` inside `<title>` tag
   - `{% block extra_css %}{% endblock %}` after Bootstrap CSS (for page-specific styles)
   - `{% block content %}{% endblock %}` inside `<body>` (main content area - no container/grid here, child templates control layout)
   - `{% block extra_js %}{% endblock %}` at end of body (for page-specific scripts)
5. Bootstrap 5.3.8 JS Bundle from jsDelivr CDN before closing `</body>` tag (before extra_js block), with SRI integrity hash:
   ```html
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz4YYwJrWVcXK/BmnVDxM+D2scQbITxI"
           crossorigin="anonymous"></script>
   ```

IMPORTANT: Use exact CDN URLs and SRI hashes from research documentation. Do NOT modify integrity hashes. Do NOT add grid/container structure to base template - child templates control their own layout.
  </action>
  <verify>
File exists at `___/templates/base.html` and contains:
- `bootstrap@5.3.8` in both CSS and JS links
- All four template blocks (title, extra_css, content, extra_js)
- SRI integrity attributes on both CDN resources
- Viewport meta tag
  </verify>
  <done>Base template exists with Bootstrap 5.3.8 CDN properly integrated and template blocks defined</done>
</task>

<task type="auto">
  <name>Task 2: Update existing templates to extend base.html</name>
  <files>
___/templates/home.html
___/templates/registration/login.html
___/templates/registration/register.html
  </files>
  <action>
For each of the three existing templates, refactor to extend base.html while preserving all existing functionality:

**For home.html:**
1. Replace entire `<!DOCTYPE html>` through `<head>` section with `{% extends 'base.html' %}`
2. Wrap existing content (h1, p, form) in `{% block content %}...{% endblock %}`
3. Remove closing `</body></html>` tags
4. Set page title: `{% block title %}Home - Pagina Madre{% endblock %}`
5. Preserve all existing template logic: `{{ user.nombre_completo|default:user.username }}`, logout form with CSRF, all Spanish text

**For registration/login.html:**
1. Replace entire `<!DOCTYPE html>` through `<head>` section with `{% extends 'base.html' %}`
2. Wrap existing content (h1, error messages, form, links) in `{% block content %}...{% endblock %}`
3. Remove closing `</body></html>` tags
4. Set page title: `{% block title %}Login - Pagina Madre{% endblock %}`
5. Preserve all existing template logic: error handling, form fields (username/password labels, remember_me checkbox), register link, all Spanish text

**For registration/register.html:**
1. Replace entire `<!DOCTYPE html>` through `<head>` section with `{% extends 'base.html' %}`
2. Wrap existing content (h1, error messages, form, links) in `{% block content %}...{% endblock %}`
3. Remove closing `</body></html>` tags
4. Set page title: `{% block title %}Register - Pagina Madre{% endblock %}`
5. Preserve all existing template logic: error handling, `{{ form.as_p }}`, login link, all Spanish text

CRITICAL: This task only changes template structure (extends base + blocks). Do NOT add Bootstrap classes, containers, or styling - that happens in Phase 5. Content remains identical.
  </action>
  <verify>
Each template file:
1. Starts with `{% extends 'base.html' %}`
2. Has `{% block title %}` with appropriate page title
3. Has `{% block content %}` wrapping all page content
4. No longer contains `<!DOCTYPE>`, `<html>`, `<head>`, or `<body>` tags
5. All original form fields, links, and text remain unchanged

Test by running development server and visiting each page:
```bash
cd /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___
python manage.py runserver
```
Visit http://127.0.0.1:8000/ (redirects to login), /register/, and after login the home page. All should render without errors.
  </verify>
  <done>All three templates extend base.html, preserve original functionality, and render without errors. Browser console shows Bootstrap CSS/JS loaded successfully.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Base template with Bootstrap 5.3.8 CDN integration and all existing pages refactored to use template inheritance.
  </what-built>
  <how-to-verify>
1. Start development server:
   ```bash
   cd /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___
   python manage.py runserver
   ```

2. Open browser to http://127.0.0.1:8000/ (should redirect to login)

3. Check browser console (F12 > Console tab):
   - Should see NO errors about missing Bootstrap resources
   - Should see Bootstrap CSS and JS successfully loaded from cdn.jsdelivr.net

4. Visual check on login page:
   - Page should render without visual errors
   - Content should be visible (even if unstyled)

5. Test registration flow:
   - Click "Create account" link
   - Registration page should render without errors
   - Content should be visible

6. Test login flow (use existing account or create new one):
   - After successful login, home page should render
   - User greeting should display
   - Logout button should be visible

7. Mobile viewport check:
   - Open browser DevTools (F12)
   - Toggle device toolbar (responsive mode)
   - Set viewport to 375px width
   - All three pages should display without horizontal scroll

**Expected outcome:** All pages render correctly, Bootstrap resources load without console errors, pages are mobile-responsive.
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues encountered</resume-signal>
</task>

</tasks>

<verification>
## Phase Verification Checklist

Run these checks to confirm Bootstrap foundation is properly established:

**1. Base Template Structure:**
```bash
# Verify base.html contains Bootstrap 5.3.8 CDN links
grep -c "bootstrap@5.3.8" /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___/templates/base.html
# Expected: 2 (CSS and JS)

# Verify SRI integrity attributes present
grep -c "integrity=" /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___/templates/base.html
# Expected: 2
```

**2. Template Inheritance:**
```bash
# Verify all templates extend base.html
grep -l "extends 'base.html'" /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___/templates/*.html /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___/templates/registration/*.html
# Expected: home.html, login.html, register.html
```

**3. Runtime Verification:**
- Visit each page with browser DevTools open
- Network tab shows successful Bootstrap resource loads (200 status)
- Console tab shows no 404 or CORS errors
- Elements tab shows Bootstrap classes in DOM (from CDN)

**4. Mobile Responsiveness:**
- Viewport meta tag present in rendered HTML source
- Pages display without horizontal scroll at 375px width
- No layout breaking at mobile viewport
</verification>

<success_criteria>
## Phase Success Criteria (Requirements R1, R2, R3)

**R1 - Base template with Bootstrap CDN:**
- [ ] base.html exists with Bootstrap 5.3.8 CSS link
- [ ] base.html includes Bootstrap 5.3.8 JS bundle
- [ ] SRI integrity hashes present on both resources
- [ ] jsDelivr CDN used (not other CDNs)

**R2 - All pages extend base template:**
- [ ] home.html extends base.html
- [ ] login.html extends base.html
- [ ] register.html extends base.html
- [ ] All pages render without template errors
- [ ] Original functionality preserved (login works, register works, logout works)

**R3 - Mobile responsiveness:**
- [ ] Viewport meta tag in base.html
- [ ] Pages display correctly at 375px viewport width
- [ ] No horizontal scrolling on mobile viewport

**Overall Success:**
Opening any page loads Bootstrap CSS/JS from CDN without console errors, all existing functionality continues to work, and pages are mobile-responsive. Foundation ready for Phase 5 styling work.
</success_criteria>

<output>
After completion, create `.planning/phases/04-bootstrap-foundation/04-01-SUMMARY.md` documenting:
- Base template structure and blocks created
- Bootstrap version and CDN used
- Template migration approach
- Any issues encountered during refactoring
- Verification results
</output>
