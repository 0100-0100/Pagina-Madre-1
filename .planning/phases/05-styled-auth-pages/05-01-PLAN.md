---
phase: 05-styled-auth-pages
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ___/accounts/forms.py
  - ___/templates/registration/login.html
autonomous: false

must_haves:
  truths:
    - "User can see login form in centered Bootstrap card"
    - "Login form fields display with Bootstrap styling (form-control)"
    - "Remember me checkbox uses Bootstrap structure"
    - "Form errors show with Bootstrap invalid feedback styling"
    - "Login button is full-width Bootstrap primary button"
  artifacts:
    - path: "___/accounts/forms.py"
      provides: "LoginForm with Bootstrap widget classes"
      contains: "class LoginForm"
      min_lines: 15
    - path: "___/templates/registration/login.html"
      provides: "Bootstrap-styled login template with card layout"
      contains: "card shadow"
      min_lines: 50
  key_links:
    - from: "___/templates/registration/login.html"
      to: "___/accounts/forms.py"
      via: "form field rendering with Bootstrap classes"
      pattern: "form-control"
    - from: "___/templates/registration/login.html"
      to: "Bootstrap CSS"
      via: "card and form classes"
      pattern: "(card|form-check|btn-primary)"
---

<objective>
Transform the login page from unstyled HTML to a professional Bootstrap 5 interface with centered card layout, styled form fields, checkbox structure, and validation feedback.

Purpose: Create a polished first impression for users accessing the authentication portal
Output: LoginForm class with Bootstrap widget attributes and fully styled login.html template
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/research/PITFALLS.md
@.planning/phases/04-bootstrap-foundation/04-01-SUMMARY.md

# Current forms.py implementation
@___/accounts/forms.py

# Current login template
@___/templates/registration/login.html

# Base template with Bootstrap
@___/templates/base.html
</context>

<tasks>

<task type="auto">
  <name>Create LoginForm with Bootstrap widget classes</name>
  <files>___/accounts/forms.py</files>
  <action>
Create a new LoginForm class in forms.py that adds Bootstrap classes to the standard AuthenticationForm widgets:

1. Import AuthenticationForm from django.contrib.auth.forms
2. Create LoginForm(AuthenticationForm) class
3. Override __init__ to add Bootstrap classes to username and password widgets:
   - username widget: attrs={'class': 'form-control', 'placeholder': 'Ingrese su cédula'}
   - password widget: attrs={'class': 'form-control', 'placeholder': 'Ingrese su contraseña'}
4. Override field labels to Spanish:
   - username: 'Cédula'
   - password: 'Contraseña'

WHY override in __init__: AuthenticationForm fields are defined at class level, so Meta.widgets won't work. Must update widget attrs in __init__ after super().__init__() call.

DO NOT modify CustomUserCreationForm yet (that's Plan 05-02).
  </action>
  <verify>
```bash
# Verify LoginForm class exists and has Bootstrap classes
grep -A 10 "class LoginForm" ___/accounts/forms.py | grep "form-control"
```
  </verify>
  <done>
LoginForm class exists in forms.py with username and password widgets configured with 'form-control' class and Spanish labels.
  </done>
</task>

<task type="auto">
  <name>Style login template with Bootstrap card and form structure</name>
  <files>___/templates/registration/login.html</files>
  <action>
Replace the current unstyled login template with Bootstrap 5 styled version:

**Layout structure:**
- Centered layout using min-vh-100, d-flex, align-items-center, justify-content-center
- Container with row and col-md-6 col-lg-5 for responsive centering
- Card with shadow class

**Form structure (inside card-body):**
1. Card header with h4 "Iniciar Sesión"
2. Django messages as Bootstrap alerts (if messages exist):
   - Loop through messages
   - Use alert-danger for error, alert-success for success
   - Include alert-dismissible with close button
3. Form fields with proper structure:
   - Cédula field: mb-3 wrapper, form-label, form-control input
   - Password field: mb-3 wrapper, form-label, form-control input
   - Add {% if field.errors %} checks to apply is-invalid class
   - Show errors in invalid-feedback divs
4. Remember me checkbox:
   - Use form-check wrapper div
   - Apply form-check-input class to checkbox
   - Apply form-check-label class to label
   - Use {{ form.remember_me.id_for_label }} for proper id/for association
5. Submit button: btn btn-primary w-100 mb-3
6. Link to registration: "¿No tienes cuenta? Crea una aquí" with Bootstrap link styling

**Critical CSRF placement:** {% csrf_token %} must be first inside <form> tag.

**Error handling:** Preserve existing form.errors check, render as Bootstrap alert-danger before form fields.

WHY manual field rendering: Need precise control over Bootstrap structure. Django's {{ form.as_p }} doesn't generate Bootstrap classes.

AVOID: Don't use floating labels (see PITFALLS.md - autofill issues). Use standard labels above inputs.
  </action>
  <verify>
```bash
# Check for Bootstrap card structure
grep "card shadow" ___/templates/registration/login.html

# Check for form-control on inputs
grep "form-control" ___/templates/registration/login.html

# Check for checkbox structure
grep "form-check" ___/templates/registration/login.html

# Verify CSRF token is first in form
grep -A 1 "<form" ___/templates/registration/login.html | grep csrf_token
```
  </verify>
  <done>
Login template contains: card with shadow, form-control on text inputs, form-check wrapper for checkbox, btn-primary for submit, centered responsive layout, and CSRF token correctly placed.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Bootstrap-styled login page with centered card, form controls, checkbox structure, and validation feedback</what-built>
  <how-to-verify>
1. Start development server:
   ```bash
   cd /Users/Diego.Lopezruiz/Documents/Repositories/Pagina-Madre-1/___
   python manage.py runserver
   ```

2. Open login page in browser:
   - URL: http://127.0.0.1:8000/accounts/login/
   - Expected: Centered card with "Iniciar Sesión" header

3. Visual checks:
   - [ ] Form displays in centered Bootstrap card with shadow
   - [ ] Cédula and Contraseña fields have styled inputs (gray border, padding)
   - [ ] "Remember me" checkbox aligned properly with label clickable
   - [ ] "Login" button is full-width blue Bootstrap primary button
   - [ ] "Create account" link visible at bottom

4. Test validation feedback:
   - Submit empty form
   - Expected: Red borders on invalid fields, error messages in red text below fields

5. Test mobile responsiveness:
   - Open browser DevTools (F12)
   - Toggle device toolbar (Ctrl+Shift+M / Cmd+Shift+M)
   - Select iPhone 12 Pro (390px width)
   - Expected: Card fills screen width, fields stack vertically, no horizontal scroll

6. Test successful login:
   - Enter valid credentials (existing user)
   - Expected: Redirects to home page

7. Test invalid login:
   - Enter invalid credentials
   - Expected: Bootstrap alert-danger appears at top with error message
  </how-to-verify>
  <resume-signal>
Type "approved" if login page looks professional and works correctly, or describe any issues found.
  </resume-signal>
</task>

</tasks>

<verification>
## Overall Phase Checks

After checkpoint approval:

1. **Visual verification:**
   - Login page renders with Bootstrap card styling
   - Form fields have consistent spacing and styling
   - Checkbox structure matches Bootstrap documentation

2. **Code verification:**
   ```bash
   # LoginForm exists with Bootstrap classes
   grep "class LoginForm" ___/accounts/forms.py

   # Template has Bootstrap structure
   grep -c "form-control" ___/templates/registration/login.html
   # Should return at least 2 (username + password)
   ```

3. **Requirements coverage:**
   - R4: Login form in centered card ✓
   - R5: Form fields have form-control class ✓
   - R6: Remember me checkbox uses form-check ✓
   - R7: Submit button is full-width primary ✓
   - R8: Validation feedback with Bootstrap classes ✓
   - R17: Django messages as Bootstrap alerts ✓
</verification>

<success_criteria>
1. LoginForm class exists in forms.py with Bootstrap widget classes applied
2. Login template renders with centered Bootstrap card (shadow, responsive)
3. Form fields (cédula, password) display with form-control styling
4. Remember me checkbox uses proper Bootstrap form-check structure
5. Form validation errors show with Bootstrap is-invalid and invalid-feedback classes
6. Django messages render as Bootstrap alerts (alert-danger/alert-success)
7. Submit button is full-width Bootstrap primary button
8. Page works correctly on mobile viewport (375px width)
9. User can successfully log in with valid credentials
10. Invalid login shows styled error feedback
</success_criteria>

<output>
After completion, create `.planning/phases/05-styled-auth-pages/05-01-SUMMARY.md`

Document:
- LoginForm implementation details
- Bootstrap classes applied
- Template structure changes
- Any deviations or issues encountered
- Screenshots or visual verification notes (optional)
</output>
